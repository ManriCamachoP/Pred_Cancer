---
title: "1_regresion_logistica"
format: html
editor: visual
---

# Configuración general

```{r}
# Configuración base de R: 
rm(list = ls(all.names = TRUE))

# Semillas:
RNGkind(sample.kind = "Rounding")

# Semilla para los análisis aleatorios: 
set.seed(1234)
```

## Librerías

```{r}
pacman::p_load(
  # Lectura y manipulación de datos: 
  tidyverse, magrittr, rio, here,
  
  # Tablas de frecuencia, gráficos y demás:
  ggthemes, scales
)
```

## Datos

```{r}
# Cargar la base de datos:
base = read_csv("C:/Users/Ivan RC/Desktop/OneDrive - Universidad Latina/I-2024/2. Análisis Multivariado/Proyectos/Pred_Cancer/data/processed/data.csv")

# Vizualizar la base:
base1 = base %>% 
  mutate_at(
    .vars = vars(State, Sex, Marital, Race, Education,
                 GeneralHealth, Exercise, TypeSmoker,
                 WalkingDiff, MentalDis, EverMammo,
                 TimeMammo, DiffCancer, BreastCancer), 
    .funs = as.factor
    ) %>% 
  rename(ID = 1)

# Cambiar la categoría de referencia en la respuesta:
base1$BreastCancer <- relevel(x = base1$BreastCancer, ref = "No Breast Cancer")
contrasts(base1$BreastCancer)

# Ver las categorías de referencia del sexo:
contrasts(base1$Sex)
```



---

# Modelo logístico

Fuente: https://stats.oarc.ucla.edu/r/dae/logit-regression/ 


## Análisis descriptivo

```{r}
base1 %>% 
  group_by(BreastCancer, Sex) %>% 
  summarise(
    casos_totales = n(),
    edad_media_persona = mean(Age, na.rm = T),
    edad_diagnostico = mean(AgeCancer, na.rm = T) 
    ) %>% 
  mutate(casos_totales = as.numeric(casos_totales))
```

## Modelo

```{r}
# Base de datos del modelo:
base_modelo = base1 %>% select(-ID)

# MOdelo:
mod1 = glm(
  formula = as.factor(BreastCancer) ~., 
  family = binomial(link = "log"),
  data = base_modelo  
  )
```













